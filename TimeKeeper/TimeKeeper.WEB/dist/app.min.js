!function(){var e=angular.module("timeKeeper",["ngRoute","ui.bootstrap","ngAnimate","toaster"]);e.constant("timeConfig",{apiUrl:"http://localhost:54283/api/",idsUrl:"http://localhost:54283/connect/token",dayType:["empty","workingday","publicholiday","otherabsence","religiousday","sickleave","vacation","businessabsence","weekend","future"],dayDesc:[" ","Working Day","Public Holiday","Other Absence","Religious Day","Sick Leave","Vacation","Business Absence"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],projectStatus:["inProgress","onHold","finished","canceled"],projectStatusDesc:["","In Progress","On Hold","Finished","Canceled"]}),e.config(["$routeProvider",function(e){e.when("/teams",{templateUrl:"views/Team/teams.html",controller:"teamsController"}).when("/employees",{templateUrl:"views/Employee/employees.html",controller:"employeesController"}).when("/customers",{templateUrl:"views/Customer/customers.html",controller:"customersController"}).when("/projects",{templateUrl:"views/Project/projects.html",controller:"projectsController"}).when("/calendar",{templateUrl:"views/Calendar/calendar.html",controller:"calendarController as $cal"}).otherwise({redirectTo:"/calendar"})}])}(),function(){var e=angular.module("timeKeeper");e.controller("calendarController",["$scope","$uibModal","dataService","timeConfig",function(e,t,o,n){function a(t,n,a){var l="calendar/"+e.employeeId;"undefined"!==e.year&&(l+="/"+e.year),"undefined"!==e.month&&(l+="/"+e.month),o.list(l,function(t){e.calendar=t,e.employeeId=t.employee.id,e.year=t.year,e.month=t.month-1,e.num=function(){var e=new Date(t.days[0].date).getDay()-1;return e<0&&(e=6),new Array(e)}})}e.dayType=n.dayType,e.months=n.months,o.list("employees?all",function(t){e.people=t}),e.buildCalendar=function(){void 0===e.employeeId?window.alert("You have to choose an employee"):a(e.employeeId,e.year,e.month+1)},e.$on("calendarUpdated",function(t){a(e.employeeId,e.year,e.month+1)}),e.edit=function(e){t.open({animation:!0,templateUrl:"views/Calendar/calendarModal.html",controller:"ModalCalendarCtrl",size:"lg",resolve:{day:function(){return e}}})}}]),e.controller("ModalCalendarCtrl",function(e,t,o,n,a){function l(){t.day.hours=0;for(var e=0;e<t.day.details.length;e++)t.day.details[e].deleted||(t.day.hours+=Number(t.day.details[e].hours))}function r(){t.newTask={id:0,description:"",hours:0,project:{id:0,name:""},deleted:!1}}t.day=a,t.dayType=n.dayDesc,o.list("projects/?all",function(e){t.projects=e}),r(),t.add=function(e){t.day.details.push(e),l(),r()},t.upd=function(e,t){l()},t.del=function(e){t.day.details[e].deleted=!0,l()},t.ok=function(){o.insert("calendar",t.day,function(e){t.$emit("calendarUpdated")}),e.close()},t.cancel=function(){e.dismiss()},t.typeChanged=function(){1!==t.day.type&&(t.day.hours=8)}})}(),function(){var e=angular.module("timeKeeper");e.controller("customersController",["$scope","dataService","$uibModal",function(e,t,o){function n(){t.list("customers",function(t){e.message="",e.customers=t})}e.message="Wait...",n(),e.$on("customersUpdated",function(e){n()}),e.new=function(e){o.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Customer/newCustModal.html",controller:"ModalCtrl",controllerAs:"$cust",resolve:{customer:function(){return e}}})}}]),e.controller("custController",["$scope","$uibModal",function(e,t){e.edit=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Customer/custModal.html",controller:"ModalCtrl",controllerAs:"$cust",resolve:{customer:function(){return e}}})},e.delete=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Customer/confirmCustDeleteModal.html",controller:"ModalCtrl",controllerAs:"$cust",resolve:{customer:function(){return e}}})},e.$on("customersUpdated",function(t){e.$emit("customersUpdated")})}]),e.controller("ModalCtrl",["$uibModalInstance","$scope","dataService","customer",function(e,t,o,n){t.customer=n,t.save=function(n){o.update("customers",n.id,n,function(e){window.alert("Data updated!")}),t.$emit("customersUpdated"),e.close()},t.cancel=function(){e.dismiss()},t.saveNew=function(n){o.insert("customers",n,function(e){window.alert("Data updated!")}),t.$emit("customersUpdated"),e.close()},t.delete=function(n){console.log(n),o.delete("customers",n.id,function(e){window.alert("Data deleted!")}),t.$emit("customersUpdated"),e.close()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("employeesController",["$scope","dataService","$uibModal",function(e,t,o){function n(){t.list("employees",function(t,o){e.page=angular.fromJson(o("Pagination")),console.log(e.page),e.message="",e.people=t})}e.message="Wait...",n(),e.edit=function(e){o.open({animation:!0,templateUrl:"views/Employee/empModal.html",controller:"empModalCtrl",controllerAs:"$emp",resolve:{employee:function(){return e}}})},e.add=function(e){o.open({animation:!0,templateUrl:"views/Employee/newEmployeeModal.html",controller:"empModalCtrl",controllerAs:"$emp",resolve:{employee:function(){return e}}})},e.view=function(e){o.open({animation:!0,templateUrl:"views/Employee/viewModal.html",controller:"empModalCtrl",resolve:{employee:function(){return e}}})},e.$on("employeesUpdated",function(e){n()})}]),e.controller("empModalCtrl",["$scope","$uibModalInstance","dataService","employee",function(e,t,o,n){e.employee=n,console.log(n),o.list("roles",function(t){e.roles=t}),e.save=function(e){console.log(e),o.update("employees",e.id,e,function(e){window.alert("Data updated!")})},e.saveNew=function(t){o.insert("employees",t,function(t){window.alert("Data inserted!"),e.$emit("employeesUpdated")})},e.cancel=function(){t.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("projectsController",["$scope","dataService","timeConfig","$location",function(e,t,o,n){e.currentPage=0,e.message="Wait...",t.list("projects",function(t,o){e.page=angular.fromJson(o("Pagination")),console.log(e),e.totalItems=e.page.totalItems,e.message="",e.projects=t,console.log(t)}),e.pageChanged=function(){t.list("projects?page="+(e.currentPage-1),function(t,o){e.projects=t}),$log.log("Page changed to: "+e.currentPage)},e.projectStatusDesc=o.projectStatusDesc}]),e.controller("projController",["$scope","$uibModal","dataService",function(e,t,o){e.edit=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Project/projModal.html",controller:"projModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.new=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Project/newProject.html",controller:"projModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})},e.view=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Project/projectProfile.html",controller:"projModalCtrl",controllerAs:"$proj",resolve:{project:function(){return e}}})}}]),e.controller("projModalCtrl",["$uibModalInstance","$scope","dataService","project",function(e,t,o,n){console.log(n),t.project=n,o.list("teams?all",function(e){t.teams=e}),o.list("customers?all",function(e){t.customers=e}),t.save=function(e){o.update("projects",e.id,e,function(e){window.alert("Data updated!")})},t.saveNew=function(e){o.insert("projects",e,function(e){window.alert("Data updated!")})},t.delete=function(e){o.delete("projects",e.id,function(e){window.alert("Data deleted!")})},t.cancel=function(){e.dismiss()}}])}(),function(){var e=angular.module("timeKeeper");e.controller("teamsController",["$scope","dataService","timeConfig","$location",function(e,t,o,n){e.currentPage=0,e.message="Wait...",t.list("teams",function(t,o){e.page=angular.fromJson(o("Pagination")),e.totalItems=e.page.totalItems,e.message="",e.teams=t,console.log(t)}),e.pageChanged=function(){t.list("teams?page="+(e.currentPage-1),function(t,o){e.projects=t}),$log.log("Page changed to: "+e.currentPage)}}]),e.controller("teaController",["$scope","$uibModal","dataService","toaster",function(e,t,o,n){e.edit=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Team/tmModal.html",controller:"tmModalCtrl",controllerAs:"$tea",resolve:{team:function(){return e}}})},e.new=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Team/newTeam.html",controller:"tmModalCtrl",controllerAs:"$tea",resolve:{team:function(){return e}}})},e.view=function(e){t.open({animation:!0,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"views/Team/teamProfile.html",controller:"tmModalCtrl",controllerAs:"$tea",resolve:{team:function(){return e}}})},e.delete=function(e){o.delete("teams",e.id,function(e){window.alert("Data deleted!")})},e.clickwar=function(t){swal({title:t.name,text:"Are you sure you want to delete this team?",type:"warning",showCancelButton:!0,customClass:"sweetClass",confirmButtonColor:"red",confirmButtonText:"Yes, sure",cancelButtonColor:"",cancelButtonText:"No, not ever!",closeOnConfirm:!1,closeOnCancel:!0},function(n){n&&(o.delete("teams",t.id,function(){e.$emit("teamsUpdated")}),console.log("Team deleted"),swal.close())})}}]),e.controller("tmModalCtrl",["$uibModalInstance","$scope","dataService","team",function(e,t,o,n){t.team=n,o.list("employees?all",function(e){t.employees=e}),o.list("projects?all",function(e){t.projects=e}),t.save=function(e){o.update("teams",e.id,e,function(e){window.alert("Data updated!")})},t.saveNew=function(e){o.insert("teams",e,function(e){window.alert("Data updated!")})},t.cancel=function(){e.dismiss()}}])}(),function(){angular.module("timeKeeper").directive("customer",[function(){return{restrict:"E",scope:{data:"="},controller:"custController as $cust",templateUrl:"views/Customer/customer-widget.html"}}])}(),function(){angular.module("timeKeeper").directive("team",[function(){return{restrict:"E",scope:{data:"="},controller:"teaController as $tea",templateUrl:"views/Team/team-widget.html"}}])}(),function(){angular.module("timeKeeper").factory("dataService",["$rootScope","$http","timeConfig","infoService",function(e,t,o,n){function a(t){e.waitForLoad=t}var l=o.apiUrl;return{list:function(e,o){a(!0),t.get(l+e).then(function(t){return a(!1),n.success(e,"data successfully retrieved"),o(t.data,t.headers)},function(t){a(!1),n.error(e,message)})},read:function(e,o,r){a(!0),t.get(l+e+"/"+o).then(function(t){return a(!1),n.success(e,"data successfully retrieved"),r(t.data)},function(t){a(!1),n.error(e,message)})},insert:function(e,o,r){a(!0),t({method:"post",url:l+e,data:o}).then(function(t){return n.success(e,"data successfully inserted"),a(!1),r(t.data)},function(t){a(!1),n.error(e,message)})},update:function(e,o,r,i){a(!0),t({method:"put",url:l+e+"/"+o,data:r}).then(function(t){return a(!1),n.success(e,"data successfully updated"),i(t.data)},function(t){a(!1),n.error(e,message)})},delete:function(e,o,r){a(!0),t({method:"delete",url:l+e+"/"+o}).then(function(t){return a(!1),n.success(e,"data successfully deleted"),r(t.data)},function(t){a(!1),n.error(e,message)})}}}])}(),function(){angular.module("timeKeeper").factory("infoService",["toaster",function(e){return{info:function(t,o){e.pop("info",t,o,3e3)},success:function(t,o){e.pop("success",t,o,3e3)},warning:function(t,o){e.pop("warning",t,o,3e3)},error:function(e,t){swal({title:e,text:t,type:"error"})}}}])}();